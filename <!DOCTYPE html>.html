<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>LINE Works WOFF App</title>
    <script src="https://static.worksmobile.com/woff-sdk/v1/woff.js"></script>
</head>
<body>
    <h1>LINE Works WOFF App</h1>
    <button id="sendMessageButton">Send Message</button>
    <script>
        // WOFFアプリの初期化
        woff.init({
            woffId: "123456-abcedfg" // 発行されたWOFF IDを指定する
        }).then(() => {
            // WOFF APIを実行する
            console.log("WOFF initialized successfully");

            // イベントリスナーを設定
            document.getElementById('sendMessageButton').addEventListener('click', function() {
                if (!woff.isInClient()) {
                    alert("This function can only be used within the LINE WORKS client.");
                } else {
                    woff.sendMessage({
                        'content': 'Hello、Works！'
                    }).then(function() {
                        window.alert('Message sent');
                    }).catch(function(error){
                        window.alert('Error sending message：' + error);
                    });
                }
            });
        }).catch((err) => {
            // 初期化処理中にエラーが発生した場合
            console.log(err.code, err.message);
        });
    </script>
</body>
</html>

